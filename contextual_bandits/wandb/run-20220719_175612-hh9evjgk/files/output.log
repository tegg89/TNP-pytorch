Experiment: Bandit Train | None
Device: cpu

Total number of parameters: 15530

[model] TNPA-S0-B8 [step] 200 [lr] 5.000e-04 [train_loss] loss 131.3318 (26.502 secs)
Generating wheel evaluation sets...
  0%|          | 0/2000 [00:00<?, ?it/s]  0%|          | 1/2000 [00:00<00:07, 250.69it/s]
Traceback (most recent call last):
  File "main.py", line 8, in <module>
    main()
  File "main.py", line 5, in main
    cmab(args)
  File "/Users/teggsung/Codes/NP/TNP-pytorch/contextual_bandits/runner/cmab_runner.py", line 47, in cmab
    train(args, model)
  File "/Users/teggsung/Codes/NP/TNP-pytorch/contextual_bandits/runner/cmab_runner.py", line 275, in train
    eval(args, [actor])
  File "/Users/teggsung/Codes/NP/TNP-pytorch/contextual_bandits/runner/cmab_runner.py", line 345, in eval
    _results = run_contextual_bandit(context_dim, num_actions, dataset, models, args.cmab_num_bs, args.device)
  File "/Users/teggsung/Codes/NP/TNP-pytorch/contextual_bandits/runner/cmab_runner.py", line 492, in run_contextual_bandit
    actions = [model.action(context, num_bs) for model in models]  # [Nm,]
  File "/Users/teggsung/Codes/NP/TNP-pytorch/contextual_bandits/runner/cmab_runner.py", line 492, in <listcomp>
    actions = [model.action(context, num_bs) for model in models]  # [Nm,]
  File "/Users/teggsung/Codes/NP/TNP-pytorch/contextual_bandits/runner/cmab_runner.py", line 618, in action
    mu, sigma = self.infer(context, num_bs)
  File "/Users/teggsung/Codes/NP/TNP-pytorch/contextual_bandits/runner/cmab_runner.py", line 639, in infer
    py = self.model.predict(xc, yc, xt)
  File "models/tnpa.py", line 81, in predict
    batch.yt = torch.zeros((xt.shape[0], xt.shape[1], yc.shape[2]), device='cuda')
  File "/Users/teggsung/anaconda3/envs/pytorch_py37/lib/python3.7/site-packages/torch/cuda/__init__.py", line 210, in _lazy_init
    raise AssertionError("Torch not compiled with CUDA enabled")
AssertionError: Torch not compiled with CUDA enabled
